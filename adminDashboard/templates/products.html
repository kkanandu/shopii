{% extends 'header.html' %}
{% load static %}
{% block header %}

<style>
  .product-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border-radius: 0.75rem;
  }

  .product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
  }

  .product-img {
    object-fit: cover;
    height: 250px;
    border-radius: 0.5rem;
  }
</style>

<!-- Banner -->
<div class="container-fluid p-0">
  <div class="position-relative">
    <img src="{% static 'assets/banner.jpg' %}" class="img-fluid w-100"
         style="max-height: 350px; object-fit: cover;">
    <div class="position-absolute top-50 start-50 translate-middle text-white text-center">
      <h2 class="display-5 fw-bold shadow-sm">Explore Listings</h2>
      <p class="lead shadow-sm d-none d-md-block">Discover houses and bikes from top renters and sellers.</p>
      <a href="{% url 'productview' %}" class="btn btn-warning btn-lg mt-2">Browse All Property</a>
    </div>
  </div>
</div>

<!-- If Filtered (Search Results) -->
{% if filtered %}
<div class="container mt-5">
  <section class="section-content">

    {% if search_type == 'house' %}
      <h2 class="mb-4 text-center">Explore Houses in "{{ query|title }}"</h2>
      {% if filtered_houses %}
        <div class="row g-4">
          {% for product in filtered_houses %}
          <div class="col-md-4">
            <div class="card product-card h-100 shadow-sm border-0">
              <a href="{% url 'detailview' product.pk %}">
                <img src="{{ product.product_image.url }}" class="product-img card-img-top" alt="{{ product.title }}">
              </a>
              <div class="card-body d-flex flex-column">
                <h5 class="card-title">{{ product.title }}</h5>
                <p class="card-text text-muted small">{{ product.description|truncatewords:15 }}</p>
                <p class="fw-bold text-success">‚Çπ {{ product.price }}</p>
                <p><strong>Location:</strong> {{ product.location }}</p>
                <div class="d-flex justify-content-between">
                  <small class="text-muted">{{ product.house_type|title }} | {{ product.date|date:"M d, Y" }}</small>
                  <a href="{% url 'detailview' product.pk %}" class="text-danger fw-bold">Checkout</a>
                </div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="alert alert-warning text-center">No houses found for "{{ query }}"</div>
      {% endif %}

      {% elif search_type == 'bike' %}
      {% if filtered_bikes %}
        <h2 class="mb-4 text-center">Explore Bikes in "{{ query|title }}"</h2>
        <div class="row g-4">
          {% for product in filtered_bikes %}
          <div class="col-md-4">
            <div class="card product-card h-100 shadow-sm border-0">
              <a href="{% url 'detailview' product.pk %}">
                <img src="{{ product.product_image.url }}" class="product-img card-img-top" alt="{{ product.title }}">
              </a>
              <div class="card-body d-flex flex-column">
                <h5 class="card-title">{{ product.title }}</h5>
                <p class="card-text text-muted small">{{ product.description|truncatewords:15 }}</p>
                <p class="fw-bold text-success">‚Çπ {{ product.price }}</p>
                <p><strong>Location:</strong> {{ product.location }}</p>
                <div class="d-flex justify-content-between">
                  <small class="text-muted">{{ product.date|date:"M d, Y" }}</small>
                  <a href="{% url 'detailview' product.pk %}" class="text-danger fw-bold">Checkout</a>
                </div>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      {% else %}
        <div class="alert alert-warning text-center">No bikes available in this location.</div>
      {% endif %}
    {% endif %}
    

  </section>
</div>

{% else %}
<!-- Not Filtered: Show all categories -->

{% if show_houses %}
<!-- Houses for Rent -->
<section class="section-content mt-5">
  <div class="container">
    <h2 class="mb-4 text-center">üè† Houses for Rent</h2>
    {% if house_rent %}
    <div class="row g-4">
      {% for product in house_rent %}
      <div class="col-md-4">
        <div class="card product-card h-100 shadow-sm border-0">
          <a href="{% url 'detailview' product.pk %}">
            <img src="{{ product.product_image.url }}" class="product-img card-img-top" alt="{{ product.title }}">
          </a>
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ product.title }}</h5>
            <p class="card-text text-muted small">{{ product.description|truncatewords:15 }}</p>
            <p class="fw-bold text-success">‚Çπ {{ product.price }}</p>
            <p><strong>Location:</strong> {{ product.location }}</p>
            <div class="d-flex justify-content-between">
              <small class="text-muted">{{ product.house_type|title }} | {{ product.date|date:"M d, Y" }}</small>
              <a href="{% url 'detailview' product.pk %}" class="text-danger fw-bold">Checkout</a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-warning text-center">No rental houses available.</div>
    {% endif %}
  </div>
</section>

<!-- Houses for Sale -->
<section class="section-content mt-5">
  <div class="container">
    <h2 class="mb-4 text-center">üè† Houses for Sale</h2>
    {% if house_sale %}
    <div class="row g-4">
      {% for product in house_sale %}
      <div class="col-md-4">
        <div class="card product-card h-100 shadow-sm border-0">
          <a href="{% url 'detailview' product.pk %}">
            <img src="{{ product.product_image.url }}" class="product-img card-img-top" alt="{{ product.title }}">
          </a>
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ product.title }}</h5>
            <p class="card-text text-muted small">{{ product.description|truncatewords:15 }}</p>
            <p class="fw-bold text-success">‚Çπ {{ product.price }}</p>
            <p><strong>Location:</strong> {{ product.location }}</p>
            <div class="d-flex justify-content-between">
              <small class="text-muted">{{ product.house_type|title }} | {{ product.date|date:"M d, Y" }}</small>
              <a href="{% url 'detailview' product.pk %}" class="text-danger fw-bold">Checkout</a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-warning text-center">No houses for sale available.</div>
    {% endif %}
  </div>
</section>
{% endif %}

{% if show_bikes %}
<!-- Bikes for Rent -->
<section class="section-content mt-5">
  <div class="container">
    <h2 class="mb-4 text-center">üèçÔ∏è Bikes for Rent</h2>
    {% if bike_rent %}
    <div class="row g-4">
      {% for product in bike_rent %}
      <div class="col-md-4">
        <div class="card product-card h-100 shadow-sm border-0">
          <a href="{% url 'detailview' product.pk %}">
            <img src="{{ product.product_image.url }}" class="product-img card-img-top" alt="{{ product.title }}">
          </a>
          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ product.title }}</h5>
            <p class="card-text text-muted small">{{ product.description|truncatewords:15 }}</p>
            <p class="fw-bold text-success">‚Çπ {{ product.price }}</p>
            <p><strong>Location:</strong> {{ product.location }}</p>
            <div class="d-flex justify-content-between">
              <small class="text-muted">{{ product.date|date:"M d, Y" }}</small>
              <a href="{% url 'detailview' product.pk %}" class="text-danger fw-bold">Checkout</a>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-info text-center">No bike rentals available.</div>
    {% endif %}
  </div>
</section>
{% endif %}

{% endif %}  {# End of not filtered block #}

{% endblock %}
