{% extends 'header.html' %}
{% load static %}
{% load widget_tweaks %}

{% block header %}
<!-- AOS Animation CSS -->
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<style>
  /* Parallax background */
  body, html {
    height: 100%;
    margin: 0;
    font-family: Arial, sans-serif;
  }

  .parallax {
    background-image: url("{% static 'assets/ad.jpg' %}");
    min-height: 100vh;
    background-attachment: fixed;
    background-position: center;
    background-repeat: no-repeat;
    background-size: cover;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 2rem;
  }

  .complaint-card {
    background: rgba(255, 255, 255, 0.95);
    padding: 2rem 2.5rem;
    border-radius: 12px;
    max-width: 600px;
    width: 100%;
    box-shadow: 0 0 20px rgba(0,0,0,0.15);
  }

  .form-label {
    font-weight: 600;
  }

  .btn-submit {
    background-color: #dc3545;
    border: none;
  }

  .btn-submit:hover {
    background-color: #b02a37;
  }
</style>

<div class="parallax" data-aos="fade-up" data-aos-duration="1200">

  <div class="complaint-card" data-aos="zoom-in" data-aos-delay="300">
    <h2 class="text-center text-danger fw-bold mb-4">ðŸš¨ Submit a Complaint</h2>

    {# Display Product name and Owner username if product is available #}
    {% if product %}
      <div class="mb-3">
        <strong>Complaint about:</strong> {{ product.title }}
      </div>
      <p><strong>House Type:</strong> {{ product.get_house_type_display }}</p>
      <div class="mb-3">
        <strong>Owner Name:</strong> {{ owner.get_full_name }}
      </div>
    {% endif %}

    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}

    <form method="POST" novalidate>
      {% csrf_token %}
      {# House Type field - only show if not hidden #}

      {# Message/details #}
      <div class="mb-3">
        <label class="form-label">Details</label>
        {{ form.message|add_class:"form-control" }}
        {% if form.message.errors %}
          <div class="text-danger small">{{ form.message.errors }}</div>
        {% endif %}
      </div>

      <div class="text-center mt-4">
        <button type="submit" class="btn btn-danger btn-submit px-4 py-2">Submit Complaint</button>
      </div>
    </form>
  </div>

</div>

<!-- AOS Animation JS -->
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
  AOS.init({
    once: true,
    easing: 'ease-out-cubic',
  });
</script>
{% endblock %}
