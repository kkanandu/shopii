<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - StayFinder</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .login-container {
            max-width: 1000px;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        .login-form {
            padding: 30px;
            background: white;
        }
        .login-banner {
            padding: 0;
            position: relative;
        }
        .login-banner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .login-header h4 {
            color: #2c3e50;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .form-control {
            border-radius: 8px;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
        }
        .form-control:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 0.25rem rgba(52, 152, 219, 0.25);
        }
        .btn-login {
            background-color: #2ecc71;
            border: none;
            color: white;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s;
            width: 100%;
        }
        .btn-login:hover {
            background-color: #27ae60;
            transform: translateY(-2px);
        }
        .btn-google {
            background-color: white;
            border: 2px solid #dee2e6;
            color: #757575;
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s;
            width: 100%;
        }
        .btn-google:hover {
            border-color: #db4a39;
            color: #db4a39;
        }
        .support-card {
            border-left: 4px solid #e74c3c;
            border-radius: 8px;
        }
        .alert-deleted {
            background-color: #fff5f5;
            border-color: #feb2b2;
            color: #c53030;
        }
    </style>
</head>
<body>
    <section class="login py-5">
        <div class="container">
            <div class="d-flex justify-content-center align-items-center">
                <div class="mt-5">
                    <div class="login-header">
                        <h4>LOGIN TO STAYFINDER</h4>
                        <p class="text-muted">Access your account to continue</p>
                    </div>

                    <!-- Messages Container -->
                    <div class="messages-container mb-4">
                        <!-- Deleted Account Message -->
                        <div class="card support-card mb-3">
                            <div class="card-body">
                                <h5 class="card-title text-danger"><i class="bi bi-exclamation-triangle-fill"></i> Account Deleted</h5>
                                <p class="card-text">Your account has been deleted by the administrator. Reason: <strong>Violation of terms of service</strong>.</p>
                                <div class="mt-3">
                                    <p class="fw-bold mb-1">ðŸ“ž Contact Support:</p>
                                    <ul class="list-unstyled mb-0">
                                        <li>ðŸ“§ support@stayfinder.com</li>
                                        <li>ðŸ“ž +91 98765 43210</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- Invalid Credentials Message -->
                        <div class="alert alert-danger alert-dismissible fade show" role="alert">
                            <strong><i class="bi bi-exclamation-circle-fill"></i> Invalid Credentials:</strong> The username or password you entered is incorrect.
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>

                        <!-- Approval Pending Message -->
                        <div class="alert alert-info alert-dismissible fade show" role="alert">
                            <strong><i class="bi bi-info-circle-fill"></i> Approval Pending:</strong> Your account is waiting for admin approval.
                            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                        </div>
                    </div>

                    <form>
                        <div class="login-container shadow">
                            <div class="row">
                                <div class="col-md-6 login-form">
                                    <div class="mb-3">
                                        <label for="username" class="form-label">Username</label>
                                        <input type="text" class="form-control" id="username" placeholder="Enter your username">
                                    </div>
                                    <div class="mb-4">
                                        <label for="password" class="form-label">Password</label>
                                        <input type="password" class="form-control" id="password" placeholder="Enter your password">
                                        <div class="form-text text-end">
                                            <a href="#!" class="text-decoration-none">Forgot password?</a>
                                        </div>
                                    </div>
                                    <div class="d-grid gap-2">
                                        <button type="submit" class="btn btn-login">Login</button>
                                    </div>
                                    <div class="text-center mt-3">
                                        <p class="mb-0">Don't have an account? <a href="#!" class="text-success text-decoration-none fw-bold">Register Here</a></p>
                                    </div>
                                    <div class="text-center mt-4">
                                        <div class="position-relative">
                                            <hr>
                                            <span class="position-absolute top-50 start-50 translate-middle bg-white px-3 text-muted">or continue with</span>
                                        </div>
                                        <a href="#!" class="btn btn-google mt-4">
                                            <i class="bi bi-google me-2"></i> 
                                            Login with Google
                                        </a>
                                    </div>
                                </div>
                                <div class="col-md-6 login-banner d-none d-md-block">
                                    <img src="https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=600&q=80" alt="Login banner" class="img-fluid">
                                </div>
                            </div>
                        </div>
                    </form>

                    <div class="text-center mt-4">
                        <p class="text-muted">By logging in, you agree to our <a href="#!" class="text-decoration-none">Terms of Service</a> and <a href="#!" class="text-decoration-none">Privacy Policy</a>.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Simple demonstration of message toggling
        document.addEventListener('DOMContentLoaded', function() {
            // In a real application, you would conditionally show messages based on server response
            // This is just for demonstration purposes
            const urlParams = new URLSearchParams(window.location.search);
            const messageType = urlParams.get('message');
            
            // Hide all messages initially
            document.querySelectorAll('.alert, .card').forEach(el => {
                el.style.display = 'none';
            });
            
            // Show specific message based on URL parameter
            if (messageType === 'invalid') {
                document.querySelector('.alert-danger').style.display = 'block';
            } else if (messageType === 'deleted') {
                document.querySelector('.support-card').style.display = 'block';
            } else if (messageType === 'approval') {
                document.querySelector('.alert-info').style.display = 'block';
            } else {
                // Show all for demonstration
                document.querySelectorAll('.alert, .card').forEach(el => {
                    el.style.display = 'block';
                });
            }
        });
    </script>
</body>
</html> -->

{% extends 'header.html' %}
{% load static widget_tweaks %}
{% load humanize %}
{% block header %}
<!-- AOS CSS -->
<link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
<!-- Particles.js -->
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
<style>
  /* Custom CSS Variables */
  :root {
    --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    --danger-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    --warning-gradient: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
    --dark-gradient: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
    --glass-bg: rgba(255, 255, 255, 0.25);
    --glass-border: rgba(255, 255, 255, 0.18);
    --shadow-light: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    --shadow-heavy: 0 20px 60px 0 rgba(0, 0, 0, 0.3);
  }
  /* Global Styles */
  body {
    background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
    background-size: 400% 400%;
    animation: gradientShift 15s ease infinite;
    min-height: 100vh;
    overflow-x: hidden;
  }
  @keyframes gradientShift {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  /* Particles Background */
  #particles-js {
    position: fixed;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    z-index: -1;
  }
  /* Glassmorphism Effects */
  .glass-card {
    background: var(--glass-bg);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border-radius: 20px;
    border: 1px solid var(--glass-border);
    box-shadow: var(--shadow-light);
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .glass-card:hover {
    transform: translateY(-10px) scale(1.02);
    box-shadow: var(--shadow-heavy);
  }
  /* Advanced Profile Card */
  .profile-card {
    background: linear-gradient(145deg, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0.1));
    backdrop-filter: blur(20px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    border-radius: 25px;
    box-shadow: 0 25px 45px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    position: relative;
  }
  .profile-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.5s;
  }
  .profile-card:hover::before {
    left: 100%;
  }
  /* Floating Profile Image */
  .profile-img-container {
    position: relative;
    perspective: 1000px;
  }
  .profile-img {
    transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    z-index: 2;
  }
  .profile-img:hover {
    transform: rotateY(15deg) rotateX(5deg) translateZ(50px);
    filter: brightness(1.1) saturate(1.2);
  }
  .profile-img::after {
    content: '';
    position: absolute;
    top: 10px;
    left: 10px;
    right: -10px;
    bottom: -10px;
    background: var(--primary-gradient);
    border-radius: 50%;
    z-index: -1;
    opacity: 0.3;
    filter: blur(20px);
    transition: all 0.3s ease;
  }
  .profile-img:hover::after {
    opacity: 0.6;
    transform: scale(1.2);
  }
  /* Morphing Cards */
  .feature-card {
    background: linear-gradient(145deg, rgba(255, 255, 255, 0.25), rgba(255, 255, 255, 0.05));
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.18);
    border-radius: 20px;
    padding: 2rem;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    cursor: pointer;
  }
  .feature-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  .feature-card:hover::before {
    opacity: 1;
  }
  .feature-card:hover {
    transform: translateY(-15px) rotateX(5deg);
    box-shadow: 0 30px 60px rgba(0, 0, 0, 0.2);
  }
  /* Liquid Button Effects */
  .liquid-btn {
    position: relative;
    background: var(--primary-gradient);
    border: none;
    border-radius: 50px;
    padding: 15px 30px;
    color: white;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    overflow: hidden;
    transition: all 0.3s ease;
    cursor: pointer;
  }
  .liquid-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    transition: left 0.5s;
  }
  .liquid-btn:hover::before {
    left: 100%;
  }
  .liquid-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
  }
  /* Floating Animation */
  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-20px); }
  }
  .floating {
    animation: float 3s ease-in-out infinite;
  }
  /* Pulse Animation */
  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }
  .pulse-animation {
    animation: pulse 2s ease-in-out infinite;
  }
  /* Neon Glow Effect */
  .neon-glow {
    animation: neonGlow 2s ease-in-out infinite alternate;
  }
  @keyframes neonGlow {
    from {
      box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
    }
    to {
      box-shadow: 0 0 30px rgba(102, 126, 234, 0.8), 0 0 40px rgba(102, 126, 234, 0.6);
    }
  }
  /* Advanced Toggle */
  .profile-card-toggle {
    position: absolute;
    top: 20px;
    right: 20px;
    z-index: 10;
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    border: 2px solid rgba(255, 255, 255, 0.3);
  }
  .profile-card-toggle:hover {
    background: rgba(255, 255, 255, 0.3);
    transform: scale(1.1) rotate(180deg);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
  }
  .profile-card-toggle i {
    font-size: 1.5rem;
    color: #fff;
    transition: transform 0.4s ease;
  }
  /* Advanced Table Styles */
  .advanced-table {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(15px);
    border-radius: 15px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
  .advanced-table thead {
    background: var(--primary-gradient);
  }
  .advanced-table tbody tr {
    background: rgba(255, 255, 255, 0.05);
    transition: all 0.3s ease;
  }
  .advanced-table tbody tr:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: scale(1.01);
  }
  /* FIXED MODAL STYLES */
  .advanced-modal .modal-dialog {
    max-width: 700px;
  }
  .advanced-modal .modal-content {
    background: linear-gradient(145deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.85));
    backdrop-filter: blur(20px);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 25px;
    box-shadow: 0 25px 45px rgba(0, 0, 0, 0.2);
    overflow: visible;
  }
  /* Modal Profile Image Section */
  .modal-profile-section {
    text-align: center;
    padding: 2rem 2rem 1rem;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  .modal-profile-img {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid #667eea;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    margin-bottom: 1rem;
  }
  .modal-profile-img:hover {
    transform: scale(1.05);
    box-shadow: 0 15px 40px rgba(102, 126, 234, 0.4);
  }
  /* Profile Image Wrapper and Edit Icon */
  .profile-image-wrapper {
    position: relative;
    display: inline-block;
    margin-bottom: 1rem;
  }
  .profile-edit-icon {
    position: absolute;
    bottom: 10px;
    right: 10px;
    background: #667eea;
    color: white;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 3px solid white;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  .profile-edit-icon:hover {
    background: #764ba2;
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
  }
  .profile-edit-icon i {
    font-size: 16px;
  }
  /* Modal Form Section */
  .modal-form-section {
    padding: 2rem;
    max-height: 400px;
    overflow-y: auto;
  }
  /* Form Field Rows */
  .form-field-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }
  .form-field-row.single {
    grid-template-columns: 1fr;
  }
  .form-group-modal {
    position: relative;
  }
  .form-group-modal label {
    font-weight: 600;
    color: #333;
    margin-bottom: 0.5rem;
    display: block;
  }
  .form-group-modal .form-control {
    border: 2px solid #e9ecef;
    border-radius: 12px;
    padding: 12px 16px;
    transition: all 0.3s ease;
    background: rgba(255, 255, 255, 0.9);
  }
  .form-group-modal .form-control:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
    transform: translateY(-2px);
    outline: none;
  }
  .form-group-modal textarea.form-control {
    min-height: 100px;
    resize: vertical;
  }
  /* Modal Footer */
  .modal-footer-fixed {
    padding: 1.5rem 2rem;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    background: rgba(255, 255, 255, 0.1);
    border-radius: 0 0 25px 25px;
  }
  /* Toast Enhancements */
  .advanced-toast {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.7));
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 15px;
    color: #333;
  }
  /* Card Grid Animation */
  .card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin-top: 3rem;
  }
  /* Reply Cards Enhancement */
  .reply-card-enhanced {
    background: linear-gradient(145deg, rgba(255, 255, 255, 0.25), rgba(255, 255, 255, 0.1));
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.18);
    border-radius: 20px;
    padding: 2rem;
    transform: translateY(50px);
    opacity: 0;
    transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }
  .reply-card-enhanced::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: var(--primary-gradient);
    border-radius: 20px;
    z-index: -1;
    opacity: 0;
    transition: opacity 0.3s ease;
  }
  .reply-card-enhanced:hover::before {
    opacity: 1;
  }
  .reply-card-enhanced:hover {
    transform: translateY(-10px) scale(1.03);
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
  }
  /* Scroll Progress Bar */
  .scroll-progress {
    position: fixed;
    top: 0;
    left: 0;
    width: 0%;
    height: 4px;
    background: var(--primary-gradient);
    z-index: 9999;
    transition: width 0.1s ease;
  }
  /* Loading Spinner */
  .loading-spinner {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    border-top-color: #fff;
    animation: spin 1s ease-in-out infinite;
  }
  @keyframes spin {
    to { transform: rotate(360deg); }
  }
  /* Responsive adjustments */
  @media (max-width: 768px) {
    .feature-card {
      margin-bottom: 1rem;
    }
    
    .profile-card {
      margin: 1rem;
    }
    .form-field-row {
      grid-template-columns: 1fr;
      gap: 1rem;
    }
    .modal-profile-section {
      padding: 1.5rem 1rem 1rem;
    }
    .modal-form-section {
      padding: 1.5rem 1rem;
    }
  }
  /* Custom scrollbar */
  ::-webkit-scrollbar {
    width: 8px;
  }
  ::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
  }
  ::-webkit-scrollbar-thumb {
    background: var(--primary-gradient);
    border-radius: 4px;
  }
  ::-webkit-scrollbar-thumb:hover {
    background: var(--secondary-gradient);
  }
</style>
{% endblock %}
{% block content %}
<!-- Particles Background -->
<div id="particles-js"></div>
<!-- Scroll Progress Bar -->
<div class="scroll-progress" id="scrollProgress"></div>
<div class="container my-5">
  <!-- Enhanced Profile Card -->
  <div class="glass-card profile-card mx-auto" style="max-width: 900px;" data-aos="fade-up" data-aos-duration="1000">
    <div class="profile-card-toggle" id="profileCardToggle">
      <i class="bi bi-chevron-up"></i>
    </div>
    
    <div class="row g-0 align-items-center p-5">
      <div class="col-md-4 text-center profile-img-container" data-aos="fade-right" data-aos-delay="200">
        <div class="profile-img floating">
          {% if user.profile_pic %}
          <img src="{{ user.profile_pic.url }}" alt="Profile Image"
            class="rounded-circle img-fluid border border-3 border-light shadow neon-glow"
            style="max-width: 200px; height: 200px; object-fit: cover;">
          {% else %}
          <img src="{% static 'default_avatar.png' %}" alt="Default Profile Image"
            class="rounded-circle img-fluid border border-3 border-light shadow neon-glow"
            style="max-width: 200px; height: 200px; object-fit: cover;">
          <p class="text-white mt-3">No profile image uploaded</p>
          {% endif %}
        </div>
      </div>
      
      <div class="col-md-8 ps-md-5 pt-3 pt-md-0 profile-card-body" id="profileCardBody" data-aos="fade-left" data-aos-delay="400">
        <div class="card-body">
          <h3 class="card-title fw-bold mb-4 text-white" style="font-size: 2.5rem;">{{ user.username }}</h3>
          <div class="info-item mb-3" data-aos="fade-up" data-aos-delay="600">
            <strong class="text-light">Name:</strong> 
            <span class="text-white ms-2">{{ user.name }}</span>
          </div>
          <div class="info-item mb-3" data-aos="fade-up" data-aos-delay="700">
            <strong class="text-light">Email:</strong> 
            <span class="badge bg-light text-dark ms-2 pulse-animation">{{ user.email }}</span>
          </div>
          <div class="info-item mb-3" data-aos="fade-up" data-aos-delay="800">
            <strong class="text-light">Phone:</strong> 
            <span class="text-white ms-2">{{ user.phone }}</span>
          </div>
          <div class="info-item mb-3" data-aos="fade-up" data-aos-delay="900">
            <strong class="text-light">Address:</strong> 
            <span class="text-white ms-2">{{ user.address|default:"Not provided" }}</span>
          </div>
          <div class="info-item mb-4" data-aos="fade-up" data-aos-delay="1000">
            <strong class="text-light">Bio:</strong> 
            <span class="text-white ms-2">{{ user.bio|default:"Not provided" }}</span>
          </div>
          <button type="button" class="liquid-btn" data-bs-toggle="modal" data-bs-target="#editProfileModal" data-aos="zoom-in" data-aos-delay="1100">
            <i class="bi bi-pencil-square me-2"></i>Edit Profile
          </button>
        </div>
      </div>
    </div>
  </div>
  <!-- Enhanced Toast Container -->
  <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1055;">
    {% if messages %}
      {% for i in messages %}
        <div class="toast advanced-toast align-items-center border-0 show" role="alert" aria-live="assertive" aria-atomic="true" data-aos="slide-left">
          <div class="d-flex">
            <div class="toast-body fw-semibold">
              <i class="bi bi-check-circle-fill text-success me-2"></i>{{ i }}
            </div>
            <button type="button" class="btn-close me-2 m-auto" data-bs-dismiss="toast"></button>
          </div>
        </div>
      {% endfor %}
    {% endif %}
  </div>
  
  <!-- Enhanced Feature Cards -->
  <div class="card-grid">
    <div class="feature-card" data-aos="flip-left" data-aos-delay="200">
      <div class="text-center">
        <div class="mb-3">
          <i class="bi bi-chat-dots-fill" style="font-size: 3rem; color: #667eea;"></i>
        </div>
        <h5 class="card-title fw-bold text-white mb-3">Chat Section</h5>
        <p class="text-light mb-4">View all your conversations with stunning animations</p>
        <button class="liquid-btn w-100">
          <i class="bi bi-arrow-right me-2"></i>View Messages
        </button>
      </div>
    </div>
    <div class="feature-card" data-aos="flip-up" data-aos-delay="400">
      <div class="text-center">
        <div class="mb-3">
          <i class="bi bi-exclamation-triangle-fill" style="font-size: 3rem; color: #e73c7e;"></i>
        </div>
        <h5 class="card-title fw-bold text-white mb-3">Complaints</h5>
        <p class="text-light mb-4">Manage all your complaints with ease</p>
        <button class="liquid-btn w-100" data-bs-toggle="collapse" href="#repliedComplaints">
          <i class="bi bi-eye me-2"></i>View Complaints
        </button>
      </div>
    </div>
    <div class="feature-card" data-aos="flip-right" data-aos-delay="600">
      <div class="text-center">
        <div class="mb-3">
          <i class="bi bi-file-earmark-text-fill" style="font-size: 3rem; color: #23d5ab;"></i>
        </div>
        <h5 class="card-title fw-bold text-white mb-3">Reports</h5>
        <p class="text-light mb-4">Track your report status instantly</p>
        <button class="liquid-btn w-100" data-bs-toggle="collapse" href="#repliedReports">
          <i class="bi bi-graph-up me-2"></i>View Reports
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Enhanced Complaints Section -->
<div class="collapse mt-5" id="repliedComplaints">
  <div class="container">
    <div class="glass-card p-5" data-aos="zoom-in">
      <h5 class="text-white fw-bold mb-5 text-center" style="font-size: 2rem;">
        <i class="bi bi-exclamation-triangle-fill me-3"></i>Your Complaints with Replies
      </h5>
      {% if complaints %}
      <div class="advanced-table table-responsive">
        <table class="table table-hover text-white">
          <thead>
            <tr>
              <th>ID</th>
              <th>Product</th>
              <th>House Type</th>
              <th>Your Message</th>
              <th>Owner's Reply</th>
              <th>Date</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            {% for complaint in complaints %}
            <tr data-aos="fade-up" data-aos-delay="{{ forloop.counter0|add:100 }}">
              <td class="fw-bold">{{ complaint.id }}</td>
              <td>
                {% if complaint.product %}
                <a href="{% url 'detailview' complaint.product.pk %}" class="text-decoration-none text-info fw-semibold">
                  {{ complaint.product.title }}
                </a>
                {% else %}
                <em class="text-muted">N/A</em>
                {% endif %}
              </td>
              <td>{{ complaint.get_house_type_display|default:"N/A" }}</td>
              <td>{{ complaint.message|linebreaksbr }}</td>
              <td>
                {% if complaint.reply %}
                <span class="text-success fw-semibold">{{ complaint.reply|linebreaksbr }}</span>
                {% else %}
                <span class="text-warning">
                  <i class="loading-spinner me-2"></i>Pending reply...
                </span>
                {% endif %}
              </td>
              <td>{{ complaint.created_at|date:"M d, Y H:i" }}</td>
              <td>
                <form method="post" action="{% url 'profile' %}" class="d-inline">
                  {% csrf_token %}
                  <input type="hidden" name="delete_complaint_id" value="{{ complaint.id }}">
                  <button type="submit" class="btn btn-sm btn-danger rounded-pill" onclick="return confirm('Are you sure?');">
                    <i class="bi bi-trash"></i>
                  </button>
                </form>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <div class="text-center" data-aos="fade-up">
        <i class="bi bi-inbox" style="font-size: 4rem; color: rgba(255, 255, 255, 0.5);"></i>
        <p class="text-light mt-3">You haven't submitted any complaints yet.</p>
      </div>
      {% endif %}
    </div>
    <!-- Enhanced Report Form -->
    <div class="glass-card p-5 mt-4" data-aos="slide-up">
      <h5 class="fw-bold text-white mb-4 text-center">
        <i class="bi bi-send-fill me-3"></i>Send a Report to Admin
      </h5>
      <form method="post" novalidate>
        {% csrf_token %}
        <div class="mb-4" data-aos="fade-right" data-aos-delay="200">
          {{ report_form.subject.label_tag }}
          {{ report_form.subject|add_class:"form-control bg-transparent text-white border-light" }}
          {% if report_form.subject.errors %}
          <div class="text-danger small">{{ report_form.subject.errors }}</div>
          {% endif %}
        </div>
        <div class="mb-4" data-aos="fade-left" data-aos-delay="400">
          {{ report_form.message.label_tag }}
          {{ report_form.message|add_class:"form-control bg-transparent text-white border-light" }}
          {% if report_form.message.errors %}
          <div class="text-danger small">{{ report_form.message.errors }}</div>
          {% endif %}
        </div>
        <button type="submit" name="submit_report" class="liquid-btn w-100" data-aos="zoom-in" data-aos-delay="600">
          <i class="bi bi-rocket-takeoff me-2"></i>Send Report
        </button>
      </form>
    </div>
  </div>
</div>
<!-- Enhanced Reports Section -->
<div class="collapse mt-5" id="repliedReports">
  <div class="container">
    <div class="glass-card p-5" data-aos="zoom-in">
      <h3 class="text-center text-white fw-bold mb-5" style="font-size: 2.5rem;">
        <i class="bi bi-reply-all-fill me-3"></i>Admin Replies to Your Reports
      </h3>
      {% if replied_reports %}
      <div class="row g-4">
        {% for report in replied_reports %}
        <div class="col-md-6 col-lg-4">
          <div class="reply-card-enhanced" data-aos="flip-up" data-aos-delay="{{ forloop.counter0|add:200 }}">
            <div class="text-center mb-3">
              <i class="bi bi-patch-check-fill" style="font-size: 2.5rem; color: #4facfe;"></i>
            </div>
            <h6 class="fw-bold text-white mb-3">{{ report.subject }}</h6>
            <p class="text-light small mb-3">
              <i class="bi bi-calendar-event me-2"></i>{{ report.replied_at|date:"M d, Y H:i" }}
            </p>
            <div class="text-white">{{ report.admin_reply|linebreaks }}</div>
          </div>
        </div>
        {% endfor %}
      </div>
      {% else %}
      <div class="text-center" data-aos="fade-up">
        <i class="bi bi-hourglass-split" style="font-size: 4rem; color: rgba(255, 255, 255, 0.5);"></i>
        <p class="text-light mt-3" style="font-style: italic;">No admin replies yet. Check back soon!</p>
      </div>
      {% endif %}
    </div>
  </div>
</div>
<!-- Enhanced Notifications -->
{% for note in unread_notifications %}
<div class="toast advanced-toast show position-fixed top-0 end-0 m-3" role="alert" data-aos="slide-left" data-aos-delay="{{ forloop.counter0|add:100 }}">
  <div class="toast-header border-0">
    <i class="bi bi-bell-fill text-primary me-2"></i>
    <strong class="me-auto">Notification</strong>
    <small class="text-muted">Just now</small>
    <button type="button" class="btn-close" data-bs-dismiss="toast"></button>
  </div>
  <div class="toast-body fw-semibold">
    {{ note.message }}
  </div>
</div>
{% endfor %}
<!-- CORRECTED ENHANCED EDIT PROFILE MODAL -->
<div class="modal fade advanced-modal" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <!-- Modal Header -->
      <div class="modal-header border-0 pb-0">
        <h5 class="modal-title fs-3 fw-bold w-100 text-center">
          <i class="bi bi-person-gear me-3"></i>Edit Profile
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form method="post" enctype="multipart/form-data" novalidate>
        {% csrf_token %}
        
        <!-- Profile Image Section -->
        <div class="modal-profile-section">
          <div class="profile-image-wrapper">
            <img id="profile-preview"
              src="{% if user.profile_pic %}{{ user.profile_pic.url }}{% else %}{% static 'default_avatar.png' %}{% endif %}"
              alt="Profile Preview" class="modal-profile-img">
            
            <label for="id_profile_pic" class="profile-edit-icon">
              <i class="fas fa-pen"></i>
            </label>
            
            <input type="file" name="profile_pic" id="id_profile_pic" accept="image/*" class="d-none" onchange="previewProfileImage(this)">
          </div>
        </div>
        <!-- Form Fields Section -->
        <div class="modal-form-section">
          <!-- First Row: Phone and Email -->
          <div class="form-field-row">
            <div class="form-group-modal">
              <label for="id_phone" class="form-label">
                <i class="bi bi-telephone me-2"></i>Phone
              </label>
              <input type="tel" class="form-control" id="id_phone" name="phone" value="{{ user.phone }}">
            </div>
            <div class="form-group-modal">
              <label for="id_email" class="form-label">
                <i class="bi bi-envelope me-2"></i>Email
              </label>
              <input type="email" class="form-control" id="id_email" name="email" value="{{ user.email }}">
            </div>
          </div>
          <!-- Second Row: Username and Name -->
          <div class="form-field-row">
            <div class="form-group-modal">
              <label for="id_username" class="form-label">
                <i class="bi bi-person-badge me-2"></i>Username
              </label>
              <input type="text" class="form-control" id="id_username" name="username" value="{{ user.username }}">
            </div>
            <div class="form-group-modal">
              <label for="id_name" class="form-label">
                <i class="bi bi-person me-2"></i>Full Name
              </label>
              <input type="text" class="form-control" id="id_name" name="name" value="{{ user.name }}">
            </div>
          </div>
          <!-- Third Row: Address (Full Width) -->
          <div class="form-field-row single">
            <div class="form-group-modal">
              <label for="id_address" class="form-label">
                <i class="bi bi-geo-alt me-2"></i>Address
              </label>
              <textarea class="form-control" id="id_address" name="address" rows="3">{{ user.address }}</textarea>
            </div>
          </div>
        </div>
        <!-- Modal Footer -->
        <div class="modal-footer-fixed">
          <button type="submit" class="liquid-btn w-100">
            <i class="bi bi-check-circle-fill me-2"></i>Save Changes
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
<!-- Scripts -->
<script>
  // Initialize particles
  particlesJS('particles-js', {
    particles: {
      number: { value: 80, density: { enable: true, value_area: 800 } },
      color: { value: "#ffffff" },
      shape: { type: "circle" },
      opacity: { value: 0.5, random: false },
      size: { value: 3, random: true },
      line_linked: { enable: true, distance: 150, color: "#ffffff", opacity: 0.4, width: 1 },
      move: { enable: true, speed: 6, direction: "none", random: false, straight: false, out_mode: "out", bounce: false }
    },
    interactivity: {
      detect_on: "canvas",
      events: { onhover: { enable: true, mode: "repulse" }, onclick: { enable: true, mode: "push" }, resize: true },
      modes: { grab: { distance: 400, line_linked: { opacity: 1 } }, bubble: { distance: 400, size: 40, duration: 2, opacity: 8, speed: 3 }, repulse: { distance: 200, duration: 0.4 }, push: { particles_nb: 4 }, remove: { particles_nb: 2 } }
    },
    retina_detect: true
  });
  // Scroll progress bar
  window.addEventListener('scroll', () => {
    const scrollTop = document.documentElement.scrollTop;
    const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
    const scrollProgress = (scrollTop / scrollHeight) * 100;
    document.getElementById('scrollProgress').style.width = scrollProgress + '%';
  });
  // Enhanced toggle functionality
  document.addEventListener('DOMContentLoaded', function() {
    const profileCardToggle = document.getElementById('profileCardToggle');
    const profileCardBody = document.getElementById('profileCardBody');
    const profileCard = document.querySelector('.profile-card');
    
    profileCardBody.style.maxHeight = profileCardBody.scrollHeight + 'px';
    
    profileCardToggle.addEventListener('click', function() {
      profileCardBody.classList.toggle('collapsed');
      profileCardToggle.classList.toggle('collapsed');
      profileCard.classList.toggle('collapsed');
      
      if (!profileCardBody.classList.contains('collapsed')) {
        profileCardBody.style.maxHeight = profileCardBody.scrollHeight + 'px';
      } else {
        profileCardBody.style.maxHeight = '0';
      }
    });
    // Auto-show toasts
    const toastElList = [].slice.call(document.querySelectorAll('.toast[data-show="true"]'));
    toastElList.forEach(function (toastEl) {
      const toast = new bootstrap.Toast(toastEl, { delay: 4000, autohide: true });
      toast.show();
    });
    // GSAP ScrollTrigger animations
    gsap.registerPlugin(ScrollTrigger);
    
    // Animate reply cards on scroll
    gsap.utils.toArray('.reply-card-enhanced').forEach((card, i) => {
      gsap.fromTo(card, 
        { y: 100, opacity: 0 },
        { 
          y: 0, 
          opacity: 1, 
          duration: 1,
          delay: i * 0.2,
          scrollTrigger: {
            trigger: card,
            start: "top 80%",
            end: "bottom 20%",
            toggleActions: "play none none reverse"
          }
        }
      );
    });
    // Smooth scroll for collapse sections
    const collapseElements = document.querySelectorAll('[data-bs-toggle="collapse"]');
    collapseElements.forEach(element => {
      element.addEventListener('click', function() {
        setTimeout(() => {
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        }, 500);
      });
    });
  });
  // Enhanced image preview
  function previewProfileImage(input) {
    const preview = document.getElementById('profile-preview');
    
    if (input.files && input.files[0]) {
      const reader = new FileReader();
      reader.onload = function (e) {
        preview.src = e.target.result;
        // Add animation effect
        gsap.fromTo(preview, 
          { scale: 0.8, opacity: 0 },
          { scale: 1, opacity: 1, duration: 0.5, ease: "back.out(1.7)" }
        );
      };
      reader.readAsDataURL(input.files[0]);
    }
  }
</script>
<!-- AOS JS -->
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
  AOS.init({
    duration: 1000,
    easing: 'ease-in-out-cubic',
    once: false,
    mirror: true
  });
</script>
{% endblock %}
